<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rekenen - Splitsstrategie</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        :root {
            --primary-color: #6200EE;
            --primary-light: #BB86FC;
            --primary-dark: #3700B3;
            --secondary-color: #03DAC6;
            --secondary-dark: #018786;
            --background-gradient-start: #6200EE;
            --background-gradient-end: #BB86FC;
            --surface-color: #FFFFFF;
            --on-surface-color: #212121;
            --on-background-color: #FFFFFF;
            --text-color-dark: var(--on-surface-color);
            --text-color-medium: #616161;
            --text-color-light: #B0B0B0;
            --color-correct: #4CAF50;
            --color-incorrect: #F44336;
            --color-info: #2196F3;
            --shadow-elevation-1: 0 2px 4px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08);
            --shadow-elevation-2: 0 4px 8px rgba(0, 0, 0, 0.15), 0 2px 5px rgba(0, 0, 0, 0.1);
            --shadow-elevation-3: 0 6px 12px rgba(0, 0, 0, 0.2), 0 3px 8px rgba(0, 0, 0, 0.15);
            --border-radius-card: 12px;
            --border-radius-button: 8px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, var(--background-gradient-start) 0%, var(--background-gradient-end) 100%);
            min-height: 100vh;
            color: var(--on-background-color);
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            width: 100%;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: var(--border-radius-card);
            backdrop-filter: blur(5px);
            box-shadow: var(--shadow-elevation-2);
        }

        .header h1 {
            color: var(--on-background-color);
            font-size: 2.8em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 6px rgba(0,0,0,0.4);
            font-weight: 700;
        }

        .header p {
            color: rgba(255,255,255,0.9);
            font-size: 1.2em;
            font-weight: 300;
        }

        .subject-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            justify-content: center;
            padding: 20px;
        }

        .subject-card {
            background-color: var(--surface-color);
            border-radius: var(--border-radius-card);
            box-shadow: var(--shadow-elevation-1);
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 200px;
            color: var(--text-color-dark);
        }

        .subject-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-elevation-2);
        }

        .subject-icon {
            font-size: 3.5em;
            margin-bottom: 20px;
            color: var(--primary-color);
        }

        .subject-card h3 {
            font-size: 1.6em;
            margin-bottom: 12px;
            color: var(--text-color-dark);
            font-weight: 500;
        }

        .subject-card p {
            font-size: 1em;
            color: var(--text-color-medium);
            line-height: 1.5;
            font-weight: 300;
        }

        .quiz-container {
            background-color: var(--surface-color);
            border-radius: var(--border-radius-card);
            box-shadow: var(--shadow-elevation-2);
            padding: 40px;
            margin-top: 20px;
            color: var(--text-color-dark);
        }

        .quiz-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .quiz-header h2 {
            font-size: 2.2em;
            color: var(--primary-color);
            margin-bottom: 20px;
            font-weight: 500;
        }

        .quiz-progress {
            background-color: #e0e0e0;
            border-radius: 10px;
            height: 12px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .quiz-progress-bar {
            height: 100%;
            width: 0%;
            background-color: var(--secondary-color);
            border-radius: 10px;
            transition: width 0.4s ease-in-out;
        }

        #questionCounter {
            font-size: 1em;
            color: var(--text-color-medium);
            font-weight: 400;
        }

        .question-container {
            margin-bottom: 30px;
            text-align: center;
        }

        .math-problem {
            background-color: #f5f5f5;
            border-radius: var(--border-radius-card);
            padding: 25px;
            margin-bottom: 20px;
            text-align: center;
            font-size: 2em;
            font-weight: 500;
            color: var(--text-color-dark);
            box-shadow: var(--shadow-elevation-1);
        }

        .question-text {
            font-size: 1.5em;
            color: var(--text-color-dark);
            margin-bottom: 30px;
            line-height: 1.6;
            font-weight: 400;
        }

        .options-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 18px;
        }

        .option {
            background-color: #f8f8f8;
            border: 2px solid #e0e0e0;
            border-radius: var(--border-radius-button);
            padding: 18px 25px;
            cursor: pointer;
            text-align: center;
            transition: background-color 0.2s ease, border-color 0.2s ease, transform 0.1s ease, box-shadow 0.2s ease;
            font-size: 1.4em;
            font-weight: 500;
            color: var(--text-color-dark);
            box-shadow: var(--shadow-elevation-1);
        }

        .option:hover {
            background-color: #eff0f0;
            border-color: var(--primary-light);
            transform: translateY(-2px);
            box-shadow: var(--shadow-elevation-1);
        }

        .option.selected {
            background-color: #e3f2fd;
            border-color: var(--primary-color);
            color: var(--text-color-dark);
            box-shadow: var(--shadow-elevation-1);
            transform: translateY(0);
        }

        .option.correct {
            background-color: #e8f5e9;
            border-color: var(--color-correct);
            color: var(--color-correct);
            font-weight: bold;
            box-shadow: var(--shadow-elevation-1);
        }

        .option.incorrect {
            background-color: #ffebee;
            border-color: var(--color-incorrect);
            color: var(--color-incorrect);
            font-weight: bold;
            box-shadow: var(--shadow-elevation-1);
        }

        .quiz-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 40px;
        }

        .btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 14px 30px;
            border-radius: var(--border-radius-button);
            cursor: pointer;
            font-size: 1.1em;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
            box-shadow: var(--shadow-elevation-1);
        }

        .btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-3px);
            box-shadow: var(--shadow-elevation-2);
        }

        .btn-secondary {
            background-color: #e0e0e0;
            color: var(--text-color-medium);
            box-shadow: var(--shadow-elevation-1);
        }

        .btn-secondary:hover {
            background-color: #c0c0c0;
            color: var(--text-color-dark);
            transform: translateY(-3px);
            box-shadow: var(--shadow-elevation-2);
        }

        .hidden {
            display: none !important;
        }

        .results-container {
            background-color: var(--surface-color);
            border-radius: var(--border-radius-card);
            box-shadow: var(--shadow-elevation-2);
            padding: 50px;
            margin-top: 20px;
            text-align: center;
            color: var(--text-color-dark);
        }

        .results-score {
            font-size: 3.5em;
            color: var(--secondary-color);
            margin-bottom: 25px;
            font-weight: 700;
        }

        .results-message {
            font-size: 1.6em;
            color: var(--text-color-dark);
            margin-bottom: 40px;
            font-weight: 400;
        }

        #feedbackSection {
            margin-top: 20px;
            padding: 15px;
            border-radius: var(--border-radius-card);
            text-align: left;
            box-shadow: var(--shadow-elevation-1);
        }

        #feedbackSection.correct {
            background-color: #e8f5e9;
            border-left: 5px solid var(--color-correct);
            color: var(--text-color-dark);
        }

        #feedbackSection.incorrect {
            background-color: #ffebee;
            border-left: 5px solid var(--color-incorrect);
            color: var(--text-color-dark);
        }

        #feedbackSection h4 {
            font-size: 1.2em;
            margin-bottom: 10px;
            color: var(--primary-dark);
        }

        #feedbackSection p {
            margin-bottom: 8px;
            line-height: 1.5;
        }

        .steps-container {
            background-color: #f9f9f9;
            border-radius: var(--border-radius-card);
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid var(--secondary-color);
        }

        .step {
            font-size: 1.1em;
            margin-bottom: 8px;
            padding: 5px 0;
            color: var(--text-color-dark);
        }

        .step:last-child {
            margin-bottom: 0;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.2em;
            }

            .subject-grid {
                grid-template-columns: 1fr;
            }

            .options-container {
                grid-template-columns: 1fr;
            }

            .quiz-container {
                padding: 25px;
            }

            .math-problem {
                font-size: 1.6em;
            }

            .question-text {
                font-size: 1.3em;
            }

            .option {
                padding: 15px 20px;
                font-size: 1.2em;
            }

            .btn {
                padding: 12px 25px;
                font-size: 1em;
            }

            .quiz-controls {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸ”¢ Rekenen met de Splitsstrategie</h1>
            <p>Leer rekenen zoals een echte rekenmeester!</p>
        </div>

        <div id="landingPage">
            <div class="subject-grid">
                <div class="subject-card" onclick="startQuizWithTheme('1 Optellen met splitsstrategie')">
                    <div class="subject-icon">âž•</div>
                    <h3>Optellen</h3>
                    <p>Leer optellen met de splitsstrategie</p>
                    <p style="color: var(--primary-color); font-weight: bold; margin-top: 5px;" id="highscore-plus">Highscore: 0</p>
                </div>
                <div class="subject-card" onclick="startQuizWithTheme('2 Aftrekken met splitsstrategie')">
                    <div class="subject-icon">âž–</div>
                    <h3>Aftrekken</h3>
                    <p>Leer aftrekken met de splitsstrategie</p>
                    <p style="color: var(--primary-color); font-weight: bold; margin-top: 5px;" id="highscore-minus">Highscore: 0</p>
                </div>
                <div class="subject-card" onclick="startQuizWithTheme('3 Gemengde oefeningen')">
                    <div class="subject-icon">ðŸ”„</div>
                    <h3>Gemengde Oefeningen</h3>
                    <p>Optellen en aftrekken door elkaar</p>
                    <p style="color: var(--primary-color); font-weight: bold; margin-top: 5px;" id="highscore-mixed">Highscore: 0</p>
                </div>
                <div class="subject-card" onclick="startQuizWithTheme(null)">
                    <div class="subject-icon">ðŸŽ¯</div>
                    <h3>Alle Oefeningen</h3>
                    <p>Test al je rekenvaardigheden</p>
                    <p style="color: var(--primary-color); font-weight: bold; margin-top: 5px;" id="highscore-all">Highscore: 0</p>
                </div>
            </div>
        </div>

        <div id="quizPage" class="quiz-container hidden">
            <div class="quiz-header">
                <h2 id="quizTitle">Rekenen Quiz</h2>
                <div class="quiz-progress">
                    <div class="quiz-progress-bar" id="progressBar"></div>
                </div>
                <div id="questionCounter">Vraag 1 van 1</div>
            </div>

            <div class="question-container">
                <div class="math-problem" id="mathProblem"></div>
                <div class="question-text" id="questionText"></div>
                <div id="optionsContainer" class="options-container"></div>
            </div>

            <div id="feedbackSection" class="hidden">
                <h4 id="feedbackTitle"></h4>
                <p id="feedbackMessage"></p>
                <div id="stepsContainer" class="steps-container hidden">
                    <h4>Zo los je het stap voor stap op:</h4>
                    <div id="stepsList"></div>
                </div>
                <p id="extraInfoDisplay" class="hidden"></p>
            </div>

            <div class="quiz-controls">
                <button class="btn btn-secondary" onclick="goToLanding()">
                    <i class="material-icons">arrow_back</i> Terug
                </button>
                <div>
                    <button class="btn" id="submitBtn" onclick="submitAnswer()">
                        <i class="material-icons">check_circle_outline</i> Antwoord
                    </button>
                    <button class="btn hidden" id="nextBtn" onclick="nextQuestion()">
                        <i class="material-icons">arrow_forward</i> Volgende
                    </button>
                </div>
            </div>
        </div>

        <div id="resultsPage" class="results-container hidden">
            <div class="results-score" id="finalScore">0/0</div>
            <div class="results-message" id="resultsMessage">Goed gedaan!</div>
            <div>
                <button class="btn" onclick="goToLanding()">
                    <i class="material-icons">home</i> Naar hoofdmenu
                </button>
                <button class="btn btn-secondary" onclick="restartQuiz()">
                    <i class="material-icons">refresh</i> Opnieuw proberen
                </button>
            </div>
        </div>
    </div>

    <script>
        // Math exercises data - embedded directly in the HTML
        const mathExercises = [
            {
                "id": 1,
                "theme": "1 Optellen met splitsstrategie",
                "question": "Los op: 28 + 15",
                "steps": [
                    "Splits 15 in 2 en 13",
                    "28 + 2 = 30",
                    "30 + 13 = 43"
                ],
                "options": [
                    "41",
                    "42", 
                    "43",
                    "44"
                ],
                "correct": 2,
                "extra_info": "De splitsstrategie helpt je door eerst naar een 'rond' tiental toe te werken. Je splitst het tweede getal zo dat je het eerste getal naar het volgende tiental kunt brengen.",
                "getal1": 28,
                "getal2": 15,
                "operation": "+"
            },
            {
                "id": 2,
                "theme": "1 Optellen met splitsstrategie",
                "question": "Los op: 37 + 24",
                "steps": [
                    "Splits 24 in 3 en 21",
                    "37 + 3 = 40",
                    "40 + 21 = 61"
                ],
                "options": [
                    "59",
                    "60",
                    "61",
                    "62"
                ],
                "correct": 2,
                "extra_info": "Door 37 eerst naar 40 te brengen, wordt de som veel makkelijker. Je hebt 3 nodig om van 37 naar 40 te gaan, dus splits je 24 in 3 en 21.",
                "getal1": 37,
                "getal2": 24,
                "operation": "+"
            },
            {
                "id": 3,
                "theme": "1 Optellen met splitsstrategie",
                "question": "Los op: 59 + 23",
                "steps": [
                    "Splits 23 in 1 en 22",
                    "59 + 1 = 60",
                    "60 + 22 = 82"
                ],
                "options": [
                    "81",
                    "82",
                    "83",
                    "84"
                ],
                "correct": 1,
                "extra_info": "Van 59 naar 60 is maar 1 stapje. Door 23 te splitsen in 1 en 22, kun je eerst naar het ronde getal 60 toe werken.",
                "getal1": 59,
                "getal2": 23,
                "operation": "+"
            },
            {
                "id": 4,
                "theme": "1 Optellen met splitsstrategie",
                "question": "Los op: 46 + 18",
                "steps": [
                    "Splits 18 in 4 en 14",
                    "46 + 4 = 50",
                    "50 + 14 = 64"
                ],
                "options": [
                    "62",
                    "63",
                    "64",
                    "65"
                ],
                "correct": 2,
                "extra_info": "46 ligt dicht bij 50. Je hebt 4 nodig om van 46 naar 50 te gaan, dus splits je 18 in 4 en 14.",
                "getal1": 46,
                "getal2": 18,
                "operation": "+"
            },
            {
                "id": 5,
                "theme": "1 Optellen met splitsstrategie",
                "question": "Los op: 68 + 17",
                "steps": [
                    "Splits 17 in 2 en 15",
                    "68 + 2 = 70",
                    "70 + 15 = 85"
                ],
                "options": [
                    "84",
                    "85",
                    "86",
                    "87"
                ],
                "correct": 1,
                "extra_info": "68 is dicht bij 70. Door 17 te splitsen in 2 en 15, bereik je eerst het ronde getal 70.",
                "getal1": 68,
                "getal2": 17,
                "operation": "+"
            },
            {
                "id": 6,
                "theme": "2 Aftrekken met splitsstrategie",
                "question": "Los op: 43 - 16",
                "steps": [
                    "Splits 16 in 3 en 13",
                    "43 - 3 = 40",
                    "40 - 13 = 27"
                ],
                "options": [
                    "25",
                    "26",
                    "27",
                    "28"
                ],
                "correct": 2,
                "extra_info": "Bij aftrekken splits je het tweede getal ook strategisch. Van 43 naar 40 is 3 aftrekken, dus splits je 16 in 3 en 13.",
                "getal1": 43,
                "getal2": 16,
                "operation": "-"
            },
            {
                "id": 7,
                "theme": "2 Aftrekken met splitsstrategie",
                "question": "Los op: 61 - 25",
                "steps": [
                    "Splits 25 in 1 en 24",
                    "61 - 1 = 60",
                    "60 - 24 = 36"
                ],
                "options": [
                    "34",
                    "35",
                    "36",
                    "37"
                ],
                "correct": 2,
                "extra_info": "61 is heel dicht bij 60. Door eerst 1 af te trekken kom je bij het ronde getal 60, dan trek je de resterende 24 eraf.",
                "getal1": 61,
                "getal2": 25,
                "operation": "-"
            },
            {
                "id": 8,
                "theme": "2 Aftrekken met splitsstrategie",
                "question": "Los op: 52 - 18",
                "steps": [
                    "Splits 18 in 2 en 16",
                    "52 - 2 = 50",
                    "50 - 16 = 34"
                ],
                "options": [
                    "32",
                    "33",
                    "34",
                    "35"
                ],
                "correct": 2,
                "extra_info": "Van 52 naar 50 moet je 2 aftrekken. Daarom splits je 18 in 2 en 16.",
                "getal1": 52,
                "getal2": 18,
                "operation": "-"
            },
            {
                "id": 9,
                "theme": "2 Aftrekken met splitsstrategie",
                "question": "Los op: 74 - 27",
                "steps": [
                    "Splits 27 in 4 en 23",
                    "74 - 4 = 70",
                    "70 - 23 = 47"
                ],
                "options": [
                    "45",
                    "46",
                    "47",
                    "48"
                ],
                "correct": 2,
                "extra_info": "74 naar 70 is 4 aftrekken. Split dus 27 in 4 en 23 om eerst naar het ronde getal te gaan.",
                "getal1": 74,
                "getal2": 27,
                "operation": "-"
            },
            {
                "id": 10,
                "theme": "2 Aftrekken met splitsstrategie",
                "question": "Los op: 85 - 38",
                "steps": [
                    "Splits 38 in 5 en 33",
                    "85 - 5 = 80",
                    "80 - 33 = 47"
                ],
                "options": [
                    "45",
                    "46",
                    "47",
                    "48"
                ],
                "correct": 2,
                "extra_info": "Van 85 naar 80 trek je 5 af. Daarom splits je 38 in 5 en 33.",
                "getal1": 85,
                "getal2": 38,
                "operation": "-"
            },
            {
                "id": 11,
                "theme": "3 Gemengde oefeningen",
                "question": "Los op: 29 + 35",
                "steps": [
                    "Splits 35 in 1 en 34",
                    "29 + 1 = 30",
                    "30 + 34 = 64"
                ],
                "options": [
                    "62",
                    "63",
                    "64",
                    "65"
                ],
                "correct": 2,
                "extra_info": "29 is heel dicht bij 30. Een klein stapje van 1 brengt je naar het ronde getal.",
                "getal1": 29,
                "getal2": 35,
                "operation": "+"
            },
            {
                "id": 12,
                "theme": "3 Gemengde oefeningen",
                "question": "Los op: 71 - 24",
                "steps": [
                    "Splits 24 in 1 en 23",
                    "71 - 1 = 70",
                    "70 - 23 = 47"
                ],
                "options": [
                    "45",
                    "46",
                    "47",
                    "48"
                ],
                "correct": 2,
                "extra_info": "71 ligt heel dicht bij 70. Door eerst 1 af te trekken, krijg je een makkelijke aftreksom.",
                "getal1": 71,
                "getal2": 24,
                "operation": "-"
            },
            {
                "id": 13,
                "theme": "3 Gemengde oefeningen",
                "question": "Los op: 48 + 26",
                "steps": [
                    "Splits 26 in 2 en 24",
                    "48 + 2 = 50",
                    "50 + 24 = 74"
                ],
                "options": [
                    "72",
                    "73",
                    "74",
                    "75"
                ],
                "correct": 2,
                "extra_info": "Van 48 naar 50 is 2 optellen. Split 26 in 2 en 24 om naar het ronde getal te werken.",
                "getal1": 48,
                "getal2": 26,
                "operation": "+"
            },
            {
                "id": 14,
                "theme": "3 Gemengde oefeningen",
                "question": "Los op: 63 - 17",
                "steps": [
                    "Splits 17 in 3 en 14",
                    "63 - 3 = 60",
                    "60 - 14 = 46"
                ],
                "options": [
                    "44",
                    "45",
                    "46",
                    "47"
                ],
                "correct": 2,
                "extra_info": "63 naar 60 is 3 aftrekken. Split dus 17 in 3 en 14.",
                "getal1": 63,
                "getal2": 17,
                "operation": "-"
            },
            {
                "id": 15,
                "theme": "3 Gemengde oefeningen",
                "question": "Los op: 57 + 28",
                "steps": [
                    "Splits 28 in 3 en 25",
                    "57 + 3 = 60",
                    "60 + 25 = 85"
                ],
                "options": [
                    "83",
                    "84",
                    "85",
                    "86"
                ],
                "correct": 2,
                "extra_info": "57 naar 60 is 3 optellen. Daarom split je 28 in 3 en 25.",
                "getal1": 57,
                "getal2": 28,
                "operation": "+"
            }
        ];

        // Quiz state variables
        let currentQuestions = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let selectedAnswer = null;
        let currentTheme = null;
        let hasAnswered = false;

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            loadHighScores();
            showLanding();
        });

        // Show landing page
        function showLanding() {
            document.getElementById('landingPage').style.display = 'block';
            document.getElementById('quizPage').classList.add('hidden');
            document.getElementById('resultsPage').classList.add('hidden');
        }

        // Start quiz with specific theme
        function startQuizWithTheme(theme) {
            currentTheme = theme;
            
            if (theme === null) {
                // All exercises
                currentQuestions = [...mathExercises];
                document.getElementById('quizTitle').textContent = 'Alle Oefeningen';
            } else {
                // Filter by theme
                currentQuestions = mathExercises.filter(exercise => exercise.theme === theme);
                document.getElementById('quizTitle').textContent = theme.replace(/^\d+\s*/, '');
            }
            
            // Shuffle questions
            currentQuestions = shuffleArray(currentQuestions);
            
            // Reset quiz state
            currentQuestionIndex = 0;
            score = 0;
            selectedAnswer = null;
            hasAnswered = false;
            
            // Show quiz page
            document.getElementById('landingPage').style.display = 'none';
            document.getElementById('quizPage').classList.remove('hidden');
            document.getElementById('resultsPage').classList.add('hidden');
            
            // Load first question
            loadQuestion();
        }

        // Shuffle array utility
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        // Load current question
        function loadQuestion() {
            if (currentQuestionIndex >= currentQuestions.length) {
                showResults();
                return;
            }

            const question = currentQuestions[currentQuestionIndex];
            
            // Update progress
            const progress = ((currentQuestionIndex) / currentQuestions.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('questionCounter').textContent = 
                `Vraag ${currentQuestionIndex + 1} van ${currentQuestions.length}`;
            
            // Display question
            document.getElementById('mathProblem').textContent = 
                `${question.getal1} ${question.operation} ${question.getal2} = ?`;
            document.getElementById('questionText').textContent = 'Kies het juiste antwoord:';
            
            // Clear previous state
            document.getElementById('feedbackSection').classList.add('hidden');
            document.getElementById('submitBtn').classList.remove('hidden');
            document.getElementById('nextBtn').classList.add('hidden');
            selectedAnswer = null;
            hasAnswered = false;
            
            // Create options
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.textContent = option;
                optionElement.onclick = () => selectOption(index);
                optionElement.dataset.index = index;
                optionsContainer.appendChild(optionElement);
            });
        }

        // Select an option
        function selectOption(index) {
            if (hasAnswered) return;
            
            // Clear previous selections
            document.querySelectorAll('.option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Select new option
            document.querySelector(`.option[data-index="${index}"]`).classList.add('selected');
            selectedAnswer = index;
        }

        // Submit answer
        function submitAnswer() {
            if (selectedAnswer === null || hasAnswered) return;
            
            hasAnswered = true;
            const question = currentQuestions[currentQuestionIndex];
            const isCorrect = selectedAnswer === question.correct;
            
            if (isCorrect) {
                score++;
            }
            
            // Show feedback
            showFeedback(isCorrect, question);
            
            // Hide submit button, show next button
            document.getElementById('submitBtn').classList.add('hidden');
            document.getElementById('nextBtn').classList.remove('hidden');
        }

        // Show feedback
        function showFeedback(isCorrect, question) {
            const feedbackSection = document.getElementById('feedbackSection');
            const feedbackTitle = document.getElementById('feedbackTitle');
            const feedbackMessage = document.getElementById('feedbackMessage');
            const stepsContainer = document.getElementById('stepsContainer');
            const stepsList = document.getElementById('stepsList');
            const extraInfoDisplay = document.getElementById('extraInfoDisplay');
            
            // Update option styles
            document.querySelectorAll('.option').forEach((option, index) => {
                if (index === question.correct) {
                    option.classList.add('correct');
                } else if (index === selectedAnswer && !isCorrect) {
                    option.classList.add('incorrect');
                }
            });
            
            // Set feedback content
            if (isCorrect) {
                feedbackSection.className = 'correct';
                feedbackTitle.textContent = 'ðŸŽ‰ Goed gedaan!';
                feedbackMessage.textContent = 'Je antwoord is juist!';
            } else {
                feedbackSection.className = 'incorrect';
                feedbackTitle.textContent = 'âŒ Helaas, dat is niet juist.';
                feedbackMessage.textContent = `Het juiste antwoord is: ${question.options[question.correct]}`;
            }
            
            // Show steps
            stepsList.innerHTML = '';
            question.steps.forEach(step => {
                const stepElement = document.createElement('div');
                stepElement.className = 'step';
                stepElement.textContent = step;
                stepsList.appendChild(stepElement);
            });
            stepsContainer.classList.remove('hidden');
            
            // Show extra info
            extraInfoDisplay.textContent = question.extra_info;
            extraInfoDisplay.classList.remove('hidden');
            
            feedbackSection.classList.remove('hidden');
        }

        // Next question
        function nextQuestion() {
            currentQuestionIndex++;
            loadQuestion();
        }

        // Show results
        function showResults() {
            const percentage = Math.round((score / currentQuestions.length) * 100);
            
            document.getElementById('finalScore').textContent = `${score}/${currentQuestions.length}`;
            
            let message = '';
            if (percentage >= 90) {
                message = 'ðŸ† Fantastisch! Je beheerst de splitsstrategie uitstekend!';
            } else if (percentage >= 70) {
                message = 'ðŸ‘ Goed gedaan! Je bent goed op weg!';
            } else if (percentage >= 50) {
                message = 'ðŸ’ª Niet slecht! Blijf oefenen en je wordt nog beter!';
            } else {
                message = 'ðŸ“š Blijf oefenen! De splitsstrategie heeft tijd nodig om te leren.';
            }
            
            document.getElementById('resultsMessage').textContent = message;
            
            // Update high score
            updateHighScore(currentTheme, score);
            
            // Show results page
            document.getElementById('quizPage').classList.add('hidden');
            document.getElementById('resultsPage').classList.remove('hidden');
        }

        // Go back to landing
        function goToLanding() {
            showLanding();
        }

        // Restart current quiz
        function restartQuiz() {
            startQuizWithTheme(currentTheme);
        }

        // High score management
        function getHighScoreKey(theme) {
            if (theme === null) return 'highscore-all';
            if (theme.includes('Optellen')) return 'highscore-plus';
            if (theme.includes('Aftrekken')) return 'highscore-minus';
            if (theme.includes('Gemengde')) return 'highscore-mixed';
            return 'highscore-all';
        }

        function loadHighScores() {
            const themes = ['highscore-plus', 'highscore-minus', 'highscore-mixed', 'highscore-all'];
            themes.forEach(theme => {
                const element = document.getElementById(theme);
                if (element) {
                    element.textContent = `Highscore: 0`; // Default score since we can't use localStorage
                }
            });
        }

        function updateHighScore(theme, newScore) {
            // In a real application, you would save this to localStorage or a server
            // For this demo, we'll just update the display temporarily
            const key = getHighScoreKey(theme);
            const element = document.getElementById(key);
            if (element) {
                element.textContent = `Highscore: ${newScore}`;
            }
        }
    </script>
</body>
</html>
                    "
